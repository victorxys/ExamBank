# 测试用例: 合同模板管理功能优化

## 1. 模板创建与版本管理

### 测试用例: TC-CREATE-001 - 创建一个全新类型的第一个模板

-   **测试目的**: 验证当为某个合同类型首次创建模板时，命名和备注功能是否正常。
-   **涉及模块/文件**: `CreateTemplateModal.jsx`, `POST /api/contract_templates`
-   **前置条件**: 数据库中不存在 `contract_type` 为 `test_type` 的任何模板。
-   **输入**:
    1.  在创建弹窗中，选择合同类型为 `test_type`。
    2.  此时，“模板名称”输入框应为可编辑状态，默认值为 `test_type制式模板`。
    3.  将模板名称修改为 `自定义测试模板`。
    4.  在“模板备注”中输入 `这是第一个测试模板`。
    5.  填写模板内容。
-   **期望输出**:
    1.  模板创建成功。
    2.  数据库中新增一条记录，其 `contract_type` 为 `test_type`，`template_name` 为 `自定义测试模板`，`version` 为 1，`remark` 为 `这是第一个测试模板`。
-   **实际输出 & 测试结果**:
    -   单元测试: [待填充]
    -   集成测试: [待填充]
    -   **最终检查结果**: [待填充]

### 测试用例: TC-CREATE-002 - 为已有类型创建新版本

-   **测试目的**: 验证为已有模板类型创建新版本时，名称锁定和版本递增是否正常。
-   **涉及模块/文件**: `CreateTemplateModal.jsx` (或另存为新版功能), `POST /api/contract_templates/ID/save_new_version`
-   **前置条件**: 已存在 `template_name` 为 `自定义测试模板`，`version` 为 1 的模板。
-   **输入**:
    1.  选择 `自定义测试模板` (v1)，点击“另存为新版”。
    2.  在弹窗中，“模板名称”输入框应为**禁用**状态，值为 `自定义测试模板`。
    3.  在“模板备注”中输入 `这是v2版本`。
    4.  修改模板内容。
-   **期望输出**:
    1.  新版本创建成功。
    2.  数据库中新增一条记录，其 `template_name` 仍为 `自定义测试模板`，但 `version` 为 2，`remark` 为 `这是v2版本`。
-   **实际输出 & 测试结果**:
    -   单元测试: [待填充]
    -   集成测试: [待填充]
    -   **最终检查结果**: [待填充]

## 2. 列表检索功能

### 测试用例: TC-SEARCH-001 - 按备注进行模糊搜索

-   **测试目的**: 验证列表页的模糊搜索功能是否对 `remark` 字段生效。
-   **涉及模块/文件**: `ContractTemplateManager.jsx`, `GET /api/contract_templates`
-   **前置条件**: 存在 `remark` 为 `这是第一个测试模板` 的模板。
-   **输入**:
    1.  在列表页的搜索框中输入 `第一个`。
-   **期望输出**:
    1.  列表中应能筛选出 `remark` 包含 `这是第一个测试模板` 的那条记录。
-   **实际输出 & 测试结果**:
    -   单元测试: [待填充]
    -   集成测试: [待填充]
    -   **最终检查结果**: [待填充]

### 测试用例: TC-SEARCH-002 - 按合同类型筛选

-   **测试目的**: 验证按 `contract_type` 筛选功能是否正常。
-   **涉及模块/文件**: `ContractTemplateManager.jsx`, `GET /api/contract_templates`
-   **前置条件**: 数据库中同时存在 `contract_type` 为 `nanny` 和 `maternity_nurse` 的模板。
-   **输入**:
    1.  在类型筛选器中，选择 `nanny`。
-   **期望输出**:
    1.  列表中只显示 `contract_type` 为 `nanny` 的模板。
-   **实际输出 & 测试结果**:
    -   单元测试: [待填充]
    -   集成测试: [待填充]
    -   **最终检查结果**: [待填充]

## 3. 跨版本对比功能

### 测试用例: TC-DIFF-001 - 对比两个同类型的模板

-   **测试目的**: 验证跨版本对比功能的核心流程。
-   **涉及模块/文件**: `ContractTemplateManager.jsx`, `CrossVersionDiffModal.jsx`, `POST /api/contract_templates/compare`
-   **前置条件**: 存在两个 `contract_type` 相同但 `content` 不同的模板（例如 TC-CREATE-001 和 TC-CREATE-002 创建的模板）。
-   **输入**:
    1.  在列表页，勾选 `自定义测试模板` v1 和 v2。
    2.  此时“对比已选”按钮应变为可用。
    3.  点击“对比已选”按钮。
-   **期望输出**:
    1.  成功弹出 `diff` 模态框。
    2.  模态框中正确显示了 v1 和 v2 模板内容的差异。
-   **实际输出 & 测试结果**:
    -   单元测试: [待填充]
    -   集成测试: [待填充]
    -   **最终检查结果**: [待填充]

### 测试用例: TC-DIFF-002 - 尝试对比两个不同类型的模板

-   **测试目的**: 验证对比功能的约束条件。
-   **涉及模块/文件**: `ContractTemplateManager.jsx`
-   **前置条件**: 存在 `contract_type` 分别为 `nanny` 和 `maternity_nurse` 的两个模板。
-   **输入**:
    1.  在列表页，勾选一个 `nanny` 模板和一个 `maternity_nurse` 模板。
-   **期望输出**:
    1.  “对比已选”按钮保持禁用状态。
-   **实际输出 & 测试结果**:
    -   单元测试: [待填充]
    -   集成测试: [待填充]
    -   **最终检查结果**: [待填充]

### 测试用例: TC-DIFF-003 - 尝试对比多于两个模板

-   **测试目的**: 验证对比功能的数量限制。
-   **涉及模块/文件**: `ContractTemplateManager.jsx`
-   **前置条件**: 存在至少3个 `contract_type` 相同的模板。
-   **输入**:
    1.  在列表页，勾选3个 `contract_type` 相同的模板。
-   **期望输出**:
    1.  “对比已选”按钮保持禁用状态。
-   **实际输出 & 测试结果**:
    -   单元测试: [待填充]
    -   集成测试: [待填充]
    -   **最终检查结果**: [待填充]
