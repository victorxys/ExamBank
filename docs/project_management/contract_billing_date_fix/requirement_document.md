# 需求文档：合同续签与变更的账单日期校准

## 1. 背景

当前系统在处理合同续签（Renew）或变更（Change）时，新的合同账单周期与旧合同的账单周期存在一天的重叠，导致服务费用被重复计算。这是一个严重的财务 bug，必须被修复。

## 2. 功能需求

### 2.1. 问题描述

- **场景**: 一个旧合同在 `T` 日结束，一个新的续签或变更合同在 `T` 日开始。
- **当前行为**:
    - 旧合同的最后一个账单周期包含 `T` 日。
    - 新合同的第一个账单周期也包含 `T` 日。
    - 导致 `T` 日当天的服务费用被计算了两次。
- **期望行为**:
    - 任何一天（24小时）的服务费用都必须且只能被一个合同的一个账单所覆盖。
    - 旧合同的计费应在 `T` 日结束。
    - 新合同的计费应从 `T+1` 日开始。

### 2.2. 核心目标

- 修复账单日期重叠导致重复计费的问题。
- 建立一个清晰、无歧义的合同周期定义，防止未来再次出现类似问题。
- 方案应具备通用性，能同时覆盖“合同续约”和“合同变更”两种业务场景。

## 3. 约束与非功能性要求

- **向后兼容性**: 解决方案不应破坏已存在的、历史合同的计费逻辑。修改应主要针对新创建的续约/变更合同。
- **用户体验**: 对前端操作的影响应尽可能小。如果需要改变UI，应使交互更清晰、更符合业务逻辑，而不是增加用户的理解成本。
- **数据一致性**: 必须保证合同日期、账单周期等核心数据在数据库中的一致性和准确性。
- **代码质量**: 拒绝“打补丁”式的解决方案。应从数据结构或核心逻辑层面进行优化，消除产生问题的“特殊情况”，体现“好品味”的设计。
