# 待办事项列表：合同账单日期校准

- **阶段一：设计与分析 (In Progress)**
    1.  [x] 创建项目管理目录和文档结构。
    2.  [x] 编写需求文档 (`requirement_document.md`)。
    3.  [x] 编写待办事项列表 (`todo_list.md`)。
    4.  [ ] 编写详细设计文档 (`design_checklist.md`)。
    5.  [ ] 编写测试用例 (`test_cases.md`)。
    6.  [ ] **核心设计决策**: 确定最终是在后端API层面处理日期+1逻辑，还是在前端提交时就处理。

- **阶段二：后端实现**
    1.  [ ] **API 梳理**: 定位处理合同“变更”和“续约”的核心后端 API Endpoint (例如 `/contracts/{id}/change` 和 `/contracts/{id}/renew`)。
    2.  [ ] **核心逻辑修改**:
        - **方案**: 实施“结束日期的后一天作为开始日期”的原则。
        - **实现**: 修改后端服务，确保在创建续约/变更合同时，新合同的 `start_date` 被正确设置为旧合同 `end_date` 的后一天。
    3.  [ ] **数据库迁移 (如果需要)**: 评估是否需要添加新的字段来明确合同之间的继承关系（例如 `previous_contract_id`），如果现有结构不清晰。
    4.  [ ] **后端单元测试**: 编写单元测试，验证在各种边界条件下（如月底、年底），新合同的开始日期都计算正确。

- **阶段三：前端调整**
    1.  [ ] **UI/UX 优化**:
        - 在“变更合同”弹窗中，将 `新合同开始日期` 的标签改为 `变更生效日期` 或 `原合同终止日期`，使其语义更清晰。
        - 确保日期选择器下的提示文本能清楚地告知用户，新合同将从此日期的第二天开始。
    2.  [ ] **API 调用调整**: 确认前端向后端传递的参数与后端修改后的期望一致。

- **阶段四：测试与验证**
    1.  [ ] **执行测试用例**: 按照 `test_cases.md` 中的场景进行手动测试和验证。
    2.  [ ] **回归测试**: 检查合同创建、普通账单生成、财务报表等相关功能是否受影响。
    3.  [ ] **代码审查 (Code Review)**: 确保后端和前端的修改都符合项目规范和“好品味”原则。

- **阶段五：部署**
    1.  [ ] 合并代码到主分支。
    2.  [ ] 部署到生产环境。
